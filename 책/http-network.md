![](http://image.yes24.com/momo/TopCate448/MidCate010/44791452.jpg)



> 그림으로 배우는 Httpnetwork 를 읽고 정리한 내용입니다. 



## 1장 웹과 네트워크에 대해서 알아보자

클라이언트에서 서버까지 일련의 흐름을 결정하고 있는 것은 웹에서 HTTP 프로토콜 (약속) 



### 역사

- CERN의 팀버너스리 박사가 멀리 떨어져 있는 동료 연구자와 지식을 공유할 수 있도록 시스템을 고안함
- 여러 문서를 상호간에 관련 짓는 하이퍼 텍스트에 의해 상호간에 참조할 수 있는 WWW의 기본 개념이 됨





### 네트워크의 기본은 TCP/IP 

- 인터넷을 포함하여 일반적으로 사용하고 있는 네트워크는 TCP/IP라는 프로토콜에서 움직이고 있다. HTTP는 그 중에 하나
- 서로 다른 하드웨어와 운영체제등을 가지고 서로 통신하기 위해서 모든 요소에 **규칙**이 필요하다. -> 프로토콜이라 부름
  - 인터넷과 관련된 프로토콜을 모은 것이 TCP/IP

![tcp/ip 4계층](https://t1.daumcdn.net/cfile/tistory/213F623C566BAE253B)

- TCP/IP 4계층
  - 인터넷이 하나의 프로토콜로 되어 있다면 어디선가 사용이 변경되었을 때 전체를 바꾸지 않으면 안되지만, 계층화 되어 있으면 사양이 변경된 해당 계층만 바꾸면 된다. 
  - Application Layer: 
  - Transport Layer: 2대의 컴퓨터 사이의 데이터 흐름 제공. (TCP / UDP 2종류)
  - Internet Layer: 네트워크 계층은 네트워크 상에서 패킷(전송하는 데이터의 최소 단위) 의 이동을 다룬다. 인터넷의 경우라면 상대 컴퓨터에 도달하는 동안에 여러 대의 컴퓨터랑 네트워크 기기를 거쳐서 상대방에서 배송된다. 여러가지 선택지 중에서 하나의 길을 결정하는 것이 네트워크 계층의 역할
  - Newtwork Access Layer: 하드웨터적인 측면 
- 통신 방법 
  - 각 계층을 거칠 때는 반드시 헤더로 불려지는 해당 계층마다 해당 계층에 필요한 정보를 추가한다. 
  - 반대로 수신측에서는 각 계층을 거칠 때마다 반드시 해당 계층마다 사용한 헤더를 삭제한다. 



### HTTP와 관계가 깊은 프로토콜 IP/ TCP / DNS

#### 1. 배송을 담당하는 IP

- 계층으로 말하면 네트워크 층에 해당됨
- IP와 IP주소를 혼동하는데, IP는 프로토콜의 명칭임 
- IP의 역할은 개개의 패킷을 상대방에게 전달하는 것
  - IP주소와 MAC(Media Access Control Address) 라는 요소가 중요함
  - IP주소는 각 노드에 부여된 주소
  - MAC주소는 각 네트워크 카드에 할당된 고유의 주소
  - IP는 MAC주소와 결부됨
  - IP주소는 변경 가능하지만 / MAC 주소는 변경 할 수 없다.



#### 2. 신뢰성을 담당하는 TCP 

- TCP 계층은 트랜스포트 층에 해당하고, 신뢰성있는 바이트 스트림 서비스를 제공한다. 
  - 바이트 스트림은 용량이 큰 데이터를 보내기 쉽게 TCP 세그멈ㄴ트라고 불리는 단위 패킷으로 작게 분해하여 관리하는 것을 말한다. 
- 확실하게 데이터를 보내기 위해서 TCP는 쓰리웨이 핸드 쉐이킹을 사용한다. 



#### 3. 이름 해결을 담당하는 DNS 

- DNS는 HTTP와 같이 응용 계층 시스템에서 도메인 이름과 IP주소 이름 확인을 제공한다. 





### URI와 URL 

- URI는 리소스 식별하기 위해 문자열 전반을 나타내는데 비해 URL은 리소스의 장소(네트워크상의 위치)를 나타낸다. URL은 URI의 서브셋 개념





## 2장. 간단한 프로토콜 HTTP

- HTTP는 상태를 계속 유지하지 않는 스테이트리스(stateless) 프로토콜입니다. 
  - 리퀘스트와 리스폰스를 교환하는 동안에 상태를 관리하지 않는다.
  - HTTP에서 새로운 리퀘스트가 보내질 때마다 새로운 리스폰스가 생성된다. 
  - HTTP/1.1은 상태를 유지하지 않는 프로토콜임
    - 그래서 쇼핑몰에서 로그인 했을 때 상태를 유지할 필요성이 있다.=> 상태를 유지 하고 싶은 요구에 부응하기 위해서  **<u>쿠키(Cookie)</u>** 기술이 도입

### 서버에 임무를 부여하는 HTTP 메서드 

- GET : 리소스 획득  - 리퀘스트 URI로 식별된 리소스를 가져올 수 있도록 요구한다. 가져올 리소스 내용은 지정된 리소스를 서버가 해석한 결과
- POST: 엔티티 전송
- PUT: 파일전송
  - HTTP/1.1 PUT자체에는 인증 기능이 없어 누구든지 파일을 업로드 가능하다는 보안 상의 문제가 존재함. 일반적인 웹사이트는 사용하지 않음
- HEAD: 메세지 헤더 취득
  - GET과 같은 기능이지만 메세지 바디는 돌려주지 않는다. URI 유효성과 리소스 갱신 시간을 확인하는 목적
- DELETE: 파일삭제
  - PUT과 반대로 동작, 리퀘스트 URI로 지정된 리소스를 삭제를 요구한다. 
  - PUT메서드와 같이 인증기능이 없어서 일반적인 웹에서 사용되지 않는다. 
- OPTIONS: 제공하고 있는 메서드의 문의
  - URI가 제공하고 있는 메서드를 조사하기 위해 사용한다. 
- TRACE: 경로 조사
  - web서버에 접속해서 자신에게 통신을 되돌려 받는 루프백을 발생시킴
  - 거의 사용되지 않음. 크로스 사이트 트레이싱과 같은 공격을 일으키는 보안상의 문제도 있다. 
- Connection: 프록시에 터널링 요구



### 지속 연결로 접속량을 절약

- HTTP 초기 버전에서는 HTTP 통신을 한 번 할 때마다 TCP에 의해 연결과 종료를 할 필요가 있었습니다. 
- HTTP/1.1 에서는 TCP연결 문제를 해결하기 위해서 지속연결이라는 방법을 고안함. 
  - 어느 한쪽이 명시적으로 연결을 종료하지 않으면, TCP연결을 계속유지함



### 쿠키를 사용한 상태관리

- HTTP는 stateless 프로토콜이기 때문에, 과거에 교환했었던Req, Res의 상태를 관리 하지 않았다. 
  - 물론 스테이트리스 프로토콜의 이점도 있다. 
    - 상태를 유지하지 않아서, 서버의 CPU나 메모리 같은 리소스의 소비를 억제할 수 있다. 
- 이와 같은 문제를 해결하기 위해서 쿠키가 도입됨.
  - **<u>쿠키는 Req와 Res 쿠키 정보를 추가해서 클라이언트의 상태를 파악하기 위한 시스템</u>**
  - **<u>쿠키는 서버에서 Res로 보내진 Set-Cookie라는 헤더 필드에 의해 쿠키를 클라이언트에 보존하게 된다.</u>** 
  - 다음 번에 클라이언트가 같은 서버로 리퀘스트를 보낼 때, 자동으로 쿠키 값을 넣어서 송신한다.
  - 서버는 클라이언트가 보내온 쿠키를 확인해서 어느 클라이언트가 접속했는지 체크하고 서버상의 기록을 확인해서 이전 상태를 알 수 있다. 



## 3장. HTTP 정보는 HTTP 메세지에 있다.

- HTTP에서 교환하는 정보는 HTTP메세지라고 불린다. 

  - HTTP 메세지는 복수행(개행 문자는 CR+LF)의 데이터로 구성된 텍스트 문자열
  - 크게 메세지 헤더와 메세지 바디로 구성됨
  - 최초에 나타나는 개행문자로 메세지 헤더와 메세제 바디를 구분한다. 



### 인코딩으로 전송 효율을 높이다. 

- HTTP 데이터를 전송할 경우 그대로 전송할 수도 있지만, 전송할 때에 인코딩(변환)을 실시함으로써 전송 효율을 높일 수 있다. 
- 전송할 때 인코딩을 하면 다량의 액세스를 효율 좋게 처리할 수 있다. 단지, 컴퓨터에서 인코딩 처리를 해야하기 때문에 CPU등의 리소스는 보다 많이 소비하게 된다.



- 압축해서 보내는 콘텐츠 코딩
  - 엔티티 정보를 유지한채 압축해서 서버에서 보내고, 클라이언트에서 받아서 복원해서 사용한다.
- 분해해서 보내는 청크 전송 코딩
  - 엔티티 바디를 청크(덩어리)로 분해한다.
  - 청크 사이즈를 16진수로 사용해서 단락을 표시하고 엔티티 바디 끝에는 "0(CR+LF)"를 기록한다.

### 여러 데이터를 보내는 멀티파트

- 메일의 경우 메일의 본문이나 복수의 첨부 파일을 붙여서 함께 보낼 수 있다. 이것은 MIME으로 불리는 여러 다른 데이터를 다루기 위한 기능을 사용하고 있다.
- HTTP도 멀티파트에 대응하고 있어 하나의 메세지 바디 내부에 엔티티를 여러 개 포함시켜 보낼 수 있다. 
  - 주로 이미지나 텍스트 파일을 업로드 할 때 사용함
  - HTTP 메세지로 멀티파트를 사용할 때에는 Content-type 헤더 필드를 사용한다. 

### 일부분만 받는 레인지 리퀘스트

- 다운로드 중에 커넥션이 끊어지게되면 처음부터 다시 다운로드를 해결하기 위해서 resume 기능이 필요해짐
- 이와 같이 범위를 지정해 리퀘스트 하는 것을 레인지 리퀘스트라고 부른다.



### 최적의 콘텐츠를 돌려주는 콘텐츠 네고시에이션

- 같은 콘텐츠이지만 여러 개의 페이지를 지닌 웹페이지( 다국어도 해당)
  - 이와 같은 구조를 Content Negotiation 이라고 부른다.
  - 컨텐츠 네고시에이션이란 클라이언트와 서버가 제공하는 리소스의 내용에 대해서 교섭하는 것
    - 클라이언트에 더욱 적합한 리소스를 제공하기 위한 구조
    - 

- ### 